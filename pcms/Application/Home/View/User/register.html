<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <meta name="keywords" content="">
    <meta name="description" content="">
    
    <title>用户注册</title>
</head>
<body>



<div id="inner_content">

<h2>用户注册</h2><br><br>
手机号码<input type="text" name="phone" id="phone" placeholder="请输入手机号码" size=30> <div id="tips"></div></div><br>
密码<input type="password" name="password" id="password" placeholder="请输入密码" size=30> <br>
再次输入密码<input type="password" name="repassword" id="repassword" placeholder="再次输入密码" size=30> <br>
<input type="button" value="提交" id="submit">
</div>


<script type="text/javascript" src="__PUBLIC__/lib/js/jquery.min.js"></script>
<script language="javascript">
$(document).ready(function(){

	
	$('#submit').click(function(){
		
		$phone = $('#phone').val();
		$pwd = $('#password').val();
		$repwd = $('#repassword').val();
		

		
		
		if($phone == '' || $pwd == '' || $repwd == ''){
			alert('null');
		}else if($pwd != $repwd){
			alert('not equal!');
		}else{
			
			
			$.ajax({
				method : 'POST',
				url : "{:U('user/only')}",
				data : {'phone':$phone},
				success: function(data){ 
                    if(data == "occupied"){
                    	$('#tips').html('手机号码被占用，请重新注册！');
                    }else{
						$.ajax({
							method : 'POST',
							url : "{:U('user/save')}",
							data : {'phone':$phone,'password':$pwd},
							success: function(data){ 
								alert(data);
								self.location.reload();							
							}
						});
                    }		
				}
			});
			
			
			

		}
	});
	

});

</script>
</body>
</html>